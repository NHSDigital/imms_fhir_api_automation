{"uid":"4b4757e66a1912dae1a509f688f20b0f","children":[{"name":"Product defects","children":[{"name":"AssertionError: FAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\nfeatures/batchTests/Steps/batch_common_steps.py:164 in validate_imms_event_table_for_all_records_in_batch_file() -> check.is_true(not valid_rows.empty, \"No rows with non-null IMMS_ID found in vaccine_df\")\n\nFAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\n------------------------------------------------------------\nFailed Checks: 2\n------------------------------------------------------------\nself = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch...nd=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_HPV', 'smoke', 'supplier_name_TPP'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrequest = <FixtureRequest for <Function test_verify_that_full_dataset_vaccination_record_will_be_created_through_batch_file>>\nfeature = Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch file', Scen...tient through batch file', tags={'Create_Batch_Feature', 'functional'}, background=None, line_number=2, description='')\nscenario = Scenario(feature=Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through ...und=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_HPV', 'smoke', 'supplier_name_TPP'}, rule=None)\n\n    def pytest_bdd_after_scenario(request, feature, scenario):\n        tags = set(getattr(scenario, 'tags', [])) | set(getattr(feature, 'tags', []))\n        context = request.getfixturevalue('context')\n        get_delete_url_header(context)\n    \n        if 'Delete_cleanUp' in tags:\n            print(f\"\\n Delete Request is {context.url}/{context.ImmsID}\")\n            context.response = requests.delete(f\"{context.url}/{context.ImmsID}\", headers=context.headers)\n            assert context.response.status_code == 204, f\"Expected status code 204, but got {context.response.status_code}. Response: {context.response.json()}\"\n    \n        if 'delete_cleanup_batch' in tags:\n            get_tokens(context, context.supplier_name)\n            context.vaccine_df[\"IMMS_ID_CLEAN\"] = context.vaccine_df[\"IMMS_ID\"].astype(str).str.replace(\"Immunization#\", \"\", regex=False)\n    \n            for imms_id in context.vaccine_df[\"IMMS_ID_CLEAN\"].dropna().unique():\n                delete_url = f\"{context.url}/{imms_id}\"\n                print(f\"Sending DELETE request to: {delete_url}\")\n                response = requests.delete(delete_url, headers=context.headers)\n    \n>               assert response.status_code == 204, (\n                    f\" Failed to delete {imms_id}: expected 204, got {response.status_code}. \"\n                    f\"Response: {response.text}\"\n                )\nE               AssertionError:  Failed to delete nan: expected 204, got 404. Response: {\"resourceType\": \"OperationOutcome\", \"id\": \"da0743bf-73b4-4c07-96c5-7dccce17dcc1\", \"meta\": {\"profile\": [\"https://simplifier.net/guide/UKCoreDevelopment2/ProfileUKCore-OperationOutcome\"]}, \"issue\": [{\"severity\": \"error\", \"code\": \"not-found\", \"details\": {\"coding\": [{\"system\": \"https://fhir.nhs.uk/Codesystem/http-error-codes\", \"code\": \"NOT-FOUND\"}]}, \"diagnostics\": \"Immunization resource does not exist. ID: nan\"}]}\nE               assert 404 == 204\nE                +  where 404 = <Response [404]>.status_code\n\nfeatures/conftest.py:97: AssertionError","children":[{"name":"Verify that full dataset vaccination record will be created through batch file","uid":"dd2e35318c2bdae4","parentUid":"6c1c3ccf1a4f3c2417b0a73cd13d3f62","status":"failed","time":{"start":1764775057293,"stop":1764775114042,"duration":56749},"flaky":false,"newFailed":false,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["supplier_name_TPP","functional","delete_cleanup_batch","vaccine_type_HPV","smoke","Create_Batch_Feature"]}],"uid":"6c1c3ccf1a4f3c2417b0a73cd13d3f62"},{"name":"AssertionError: FAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\nfeatures/batchTests/Steps/batch_common_steps.py:164 in validate_imms_event_table_for_all_records_in_batch_file() -> check.is_true(not valid_rows.empty, \"No rows with non-null IMMS_ID found in vaccine_df\")\n\nFAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\n------------------------------------------------------------\nFailed Checks: 2\n------------------------------------------------------------\nself = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch...nd=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_MMR', 'smoke', 'supplier_name_TPP'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrequest = <FixtureRequest for <Function test_verify_that_minimum_dataset_vaccination_record_will_be_created_through_batch_file>>\nfeature = Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch file', Scen...tient through batch file', tags={'Create_Batch_Feature', 'functional'}, background=None, line_number=2, description='')\nscenario = Scenario(feature=Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through ...und=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_MMR', 'smoke', 'supplier_name_TPP'}, rule=None)\n\n    def pytest_bdd_after_scenario(request, feature, scenario):\n        tags = set(getattr(scenario, 'tags', [])) | set(getattr(feature, 'tags', []))\n        context = request.getfixturevalue('context')\n        get_delete_url_header(context)\n    \n        if 'Delete_cleanUp' in tags:\n            print(f\"\\n Delete Request is {context.url}/{context.ImmsID}\")\n            context.response = requests.delete(f\"{context.url}/{context.ImmsID}\", headers=context.headers)\n            assert context.response.status_code == 204, f\"Expected status code 204, but got {context.response.status_code}. Response: {context.response.json()}\"\n    \n        if 'delete_cleanup_batch' in tags:\n            get_tokens(context, context.supplier_name)\n            context.vaccine_df[\"IMMS_ID_CLEAN\"] = context.vaccine_df[\"IMMS_ID\"].astype(str).str.replace(\"Immunization#\", \"\", regex=False)\n    \n            for imms_id in context.vaccine_df[\"IMMS_ID_CLEAN\"].dropna().unique():\n                delete_url = f\"{context.url}/{imms_id}\"\n                print(f\"Sending DELETE request to: {delete_url}\")\n                response = requests.delete(delete_url, headers=context.headers)\n    \n>               assert response.status_code == 204, (\n                    f\" Failed to delete {imms_id}: expected 204, got {response.status_code}. \"\n                    f\"Response: {response.text}\"\n                )\nE               AssertionError:  Failed to delete nan: expected 204, got 404. Response: {\"resourceType\": \"OperationOutcome\", \"id\": \"23392c1a-5bef-42f6-a204-5eae9e8d4377\", \"meta\": {\"profile\": [\"https://simplifier.net/guide/UKCoreDevelopment2/ProfileUKCore-OperationOutcome\"]}, \"issue\": [{\"severity\": \"error\", \"code\": \"not-found\", \"details\": {\"coding\": [{\"system\": \"https://fhir.nhs.uk/Codesystem/http-error-codes\", \"code\": \"NOT-FOUND\"}]}, \"diagnostics\": \"Immunization resource does not exist. ID: nan\"}]}\nE               assert 404 == 204\nE                +  where 404 = <Response [404]>.status_code\n\nfeatures/conftest.py:97: AssertionError","children":[{"name":"Verify that minimum dataset vaccination record will be created through batch file","uid":"f90f8bd355bc524f","parentUid":"3b86887dcef86622a7689c25481682b8","status":"failed","time":{"start":1764775114072,"stop":1764775160242,"duration":46170},"flaky":false,"newFailed":true,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["supplier_name_TPP","functional","vaccine_type_MMR","delete_cleanup_batch","smoke","Create_Batch_Feature"]}],"uid":"3b86887dcef86622a7689c25481682b8"},{"name":"AssertionError: FAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\nfeatures/batchTests/Steps/batch_common_steps.py:164 in validate_imms_event_table_for_all_records_in_batch_file() -> check.is_true(not valid_rows.empty, \"No rows with non-null IMMS_ID found in vaccine_df\")\n\nFAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\n------------------------------------------------------------\nFailed Checks: 2","children":[{"name":"verify that vaccination record will be get successful if performer is invalid in batch file","uid":"b1aca96aa36c1802","parentUid":"f77bfe7873e48310dcb77b54dcb1779c","status":"failed","time":{"start":1764775371961,"stop":1764775416190,"duration":44229},"flaky":false,"newFailed":true,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["vaccine_type_FLU","functional","Create_Batch_Feature","supplier_name_MAVIS"]},{"name":"verify that vaccination record will be get successful with different valid value in gender field","uid":"b0edfb25e48948e4","parentUid":"f77bfe7873e48310dcb77b54dcb1779c","status":"failed","time":{"start":1764775416194,"stop":1764775455283,"duration":39089},"flaky":false,"newFailed":true,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["vaccine_type_FLU","functional","supplier_name_SONAR","Create_Batch_Feature"]}],"uid":"f77bfe7873e48310dcb77b54dcb1779c"},{"name":"AssertionError: FAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\nfeatures/batchTests/Steps/batch_common_steps.py:164 in validate_imms_event_table_for_all_records_in_batch_file() -> check.is_true(not valid_rows.empty, \"No rows with non-null IMMS_ID found in vaccine_df\")\n\nFAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\n------------------------------------------------------------\nFailed Checks: 2\n------------------------------------------------------------\nself = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch...ckground=None)], description='', tags={'delete_cleanup_batch', 'supplier_name_EMIS', 'vaccine_type_COVID'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrequest = <FixtureRequest for <Function test_verify_that_vaccination_record_will_be_successful_if_mandatory_field_for_site_location_and_unique_uri_are_invalid_in_batch_file>>\nfeature = Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch file', Scen...tient through batch file', tags={'Create_Batch_Feature', 'functional'}, background=None, line_number=2, description='')\nscenario = Scenario(feature=Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through ...ackground=None)], description='', tags={'delete_cleanup_batch', 'supplier_name_EMIS', 'vaccine_type_COVID'}, rule=None)\n\n    def pytest_bdd_after_scenario(request, feature, scenario):\n        tags = set(getattr(scenario, 'tags', [])) | set(getattr(feature, 'tags', []))\n        context = request.getfixturevalue('context')\n        get_delete_url_header(context)\n    \n        if 'Delete_cleanUp' in tags:\n            print(f\"\\n Delete Request is {context.url}/{context.ImmsID}\")\n            context.response = requests.delete(f\"{context.url}/{context.ImmsID}\", headers=context.headers)\n            assert context.response.status_code == 204, f\"Expected status code 204, but got {context.response.status_code}. Response: {context.response.json()}\"\n    \n        if 'delete_cleanup_batch' in tags:\n            get_tokens(context, context.supplier_name)\n            context.vaccine_df[\"IMMS_ID_CLEAN\"] = context.vaccine_df[\"IMMS_ID\"].astype(str).str.replace(\"Immunization#\", \"\", regex=False)\n    \n            for imms_id in context.vaccine_df[\"IMMS_ID_CLEAN\"].dropna().unique():\n                delete_url = f\"{context.url}/{imms_id}\"\n                print(f\"Sending DELETE request to: {delete_url}\")\n                response = requests.delete(delete_url, headers=context.headers)\n    \n>               assert response.status_code == 204, (\n                    f\" Failed to delete {imms_id}: expected 204, got {response.status_code}. \"\n                    f\"Response: {response.text}\"\n                )\nE               AssertionError:  Failed to delete nan: expected 204, got 404. Response: {\"resourceType\": \"OperationOutcome\", \"id\": \"3485c4d5-8d5b-4c50-ba85-cd1428973124\", \"meta\": {\"profile\": [\"https://simplifier.net/guide/UKCoreDevelopment2/ProfileUKCore-OperationOutcome\"]}, \"issue\": [{\"severity\": \"error\", \"code\": \"not-found\", \"details\": {\"coding\": [{\"system\": \"https://fhir.nhs.uk/Codesystem/http-error-codes\", \"code\": \"NOT-FOUND\"}]}, \"diagnostics\": \"Immunization resource does not exist. ID: nan\"}]}\nE               assert 404 == 204\nE                +  where 404 = <Response [404]>.status_code\n\nfeatures/conftest.py:97: AssertionError","children":[{"name":"verify that vaccination record will be successful if mandatory field for site, location and unique URI are invalid in batch file","uid":"5fc99c0b58348202","parentUid":"adc79f0221de57dd5ec2d72787edae31","status":"failed","time":{"start":1764775494728,"stop":1764775537913,"duration":43185},"flaky":false,"newFailed":true,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["functional","delete_cleanup_batch","Create_Batch_Feature","vaccine_type_COVID","supplier_name_EMIS"]}],"uid":"adc79f0221de57dd5ec2d72787edae31"},{"name":"AssertionError: FAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\nfeatures/batchTests/Steps/batch_common_steps.py:164 in validate_imms_event_table_for_all_records_in_batch_file() -> check.is_true(not valid_rows.empty, \"No rows with non-null IMMS_ID found in vaccine_df\")\n\nFAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\n------------------------------------------------------------\nFailed Checks: 2\n------------------------------------------------------------\nself = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch...kground=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_MENACWY', 'supplier_name_TPP'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrequest = <FixtureRequest for <Function test_verify_that_vaccination_record_will_be_get_successful_if_action_flag_has_different_cases>>\nfeature = Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch file', Scen...tient through batch file', tags={'Create_Batch_Feature', 'functional'}, background=None, line_number=2, description='')\nscenario = Scenario(feature=Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through ...ckground=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_MENACWY', 'supplier_name_TPP'}, rule=None)\n\n    def pytest_bdd_after_scenario(request, feature, scenario):\n        tags = set(getattr(scenario, 'tags', [])) | set(getattr(feature, 'tags', []))\n        context = request.getfixturevalue('context')\n        get_delete_url_header(context)\n    \n        if 'Delete_cleanUp' in tags:\n            print(f\"\\n Delete Request is {context.url}/{context.ImmsID}\")\n            context.response = requests.delete(f\"{context.url}/{context.ImmsID}\", headers=context.headers)\n            assert context.response.status_code == 204, f\"Expected status code 204, but got {context.response.status_code}. Response: {context.response.json()}\"\n    \n        if 'delete_cleanup_batch' in tags:\n            get_tokens(context, context.supplier_name)\n            context.vaccine_df[\"IMMS_ID_CLEAN\"] = context.vaccine_df[\"IMMS_ID\"].astype(str).str.replace(\"Immunization#\", \"\", regex=False)\n    \n            for imms_id in context.vaccine_df[\"IMMS_ID_CLEAN\"].dropna().unique():\n                delete_url = f\"{context.url}/{imms_id}\"\n                print(f\"Sending DELETE request to: {delete_url}\")\n                response = requests.delete(delete_url, headers=context.headers)\n    \n>               assert response.status_code == 204, (\n                    f\" Failed to delete {imms_id}: expected 204, got {response.status_code}. \"\n                    f\"Response: {response.text}\"\n                )\nE               AssertionError:  Failed to delete nan: expected 204, got 404. Response: {\"resourceType\": \"OperationOutcome\", \"id\": \"aab968a8-57f6-41ef-9251-5e71988487bf\", \"meta\": {\"profile\": [\"https://simplifier.net/guide/UKCoreDevelopment2/ProfileUKCore-OperationOutcome\"]}, \"issue\": [{\"severity\": \"error\", \"code\": \"not-found\", \"details\": {\"coding\": [{\"system\": \"https://fhir.nhs.uk/Codesystem/http-error-codes\", \"code\": \"NOT-FOUND\"}]}, \"diagnostics\": \"Immunization resource does not exist. ID: nan\"}]}\nE               assert 404 == 204\nE                +  where 404 = <Response [404]>.status_code\n\nfeatures/conftest.py:97: AssertionError","children":[{"name":"verify that vaccination record will be get successful if action flag has different cases","uid":"76c47f525e0f8391","parentUid":"43e0698d397155bc6016f20525085835","status":"failed","time":{"start":1764775537936,"stop":1764775578917,"duration":40981},"flaky":false,"newFailed":true,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["vaccine_type_MENACWY","supplier_name_TPP","functional","delete_cleanup_batch","Create_Batch_Feature"]}],"uid":"43e0698d397155bc6016f20525085835"},{"name":"AssertionError: FAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\nfeatures/batchTests/Steps/batch_common_steps.py:164 in validate_imms_event_table_for_all_records_in_batch_file() -> check.is_true(not valid_rows.empty, \"No rows with non-null IMMS_ID found in vaccine_df\")\n\nFAILURE: check bool(False): No rows with non-null IMMS_ID found in vaccine_df\n------------------------------------------------------------\nFailed Checks: 2\n------------------------------------------------------------\nself = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch...background=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_3in1', 'supplier_name_TPP'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nrequest = <FixtureRequest for <Function test_verify_that_vaccination_record_will_be_get_successful_if_non_mandatory_fields_are_missing_in_batch_file>>\nfeature = Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through batch file', Scen...tient through batch file', tags={'Create_Batch_Feature', 'functional'}, background=None, line_number=2, description='')\nscenario = Scenario(feature=Feature(scenarios=OrderedDict([('Verify that full dataset vaccination record will be created through ... background=None)], description='', tags={'delete_cleanup_batch', 'vaccine_type_3in1', 'supplier_name_TPP'}, rule=None)\n\n    def pytest_bdd_after_scenario(request, feature, scenario):\n        tags = set(getattr(scenario, 'tags', [])) | set(getattr(feature, 'tags', []))\n        context = request.getfixturevalue('context')\n        get_delete_url_header(context)\n    \n        if 'Delete_cleanUp' in tags:\n            print(f\"\\n Delete Request is {context.url}/{context.ImmsID}\")\n            context.response = requests.delete(f\"{context.url}/{context.ImmsID}\", headers=context.headers)\n            assert context.response.status_code == 204, f\"Expected status code 204, but got {context.response.status_code}. Response: {context.response.json()}\"\n    \n        if 'delete_cleanup_batch' in tags:\n            get_tokens(context, context.supplier_name)\n            context.vaccine_df[\"IMMS_ID_CLEAN\"] = context.vaccine_df[\"IMMS_ID\"].astype(str).str.replace(\"Immunization#\", \"\", regex=False)\n    \n            for imms_id in context.vaccine_df[\"IMMS_ID_CLEAN\"].dropna().unique():\n                delete_url = f\"{context.url}/{imms_id}\"\n                print(f\"Sending DELETE request to: {delete_url}\")\n                response = requests.delete(delete_url, headers=context.headers)\n    \n>               assert response.status_code == 204, (\n                    f\" Failed to delete {imms_id}: expected 204, got {response.status_code}. \"\n                    f\"Response: {response.text}\"\n                )\nE               AssertionError:  Failed to delete nan: expected 204, got 404. Response: {\"resourceType\": \"OperationOutcome\", \"id\": \"aee19728-5ce2-470f-b54d-efc53bd94b5b\", \"meta\": {\"profile\": [\"https://simplifier.net/guide/UKCoreDevelopment2/ProfileUKCore-OperationOutcome\"]}, \"issue\": [{\"severity\": \"error\", \"code\": \"not-found\", \"details\": {\"coding\": [{\"system\": \"https://fhir.nhs.uk/Codesystem/http-error-codes\", \"code\": \"NOT-FOUND\"}]}, \"diagnostics\": \"Immunization resource does not exist. ID: nan\"}]}\nE               assert 404 == 204\nE                +  where 404 = <Response [404]>.status_code\n\nfeatures/conftest.py:97: AssertionError","children":[{"name":"verify that vaccination record will be get successful if non mandatory fields are missing in batch file","uid":"630a26c7989d6e77","parentUid":"c13285ab85b8fcde6241c4d34b6035d5","status":"failed","time":{"start":1764775628267,"stop":1764775669436,"duration":41169},"flaky":false,"newFailed":true,"newPassed":false,"newBroken":false,"retriesCount":0,"retriesStatusChange":false,"parameters":[],"tags":["vaccine_type_3in1","supplier_name_TPP","functional","delete_cleanup_batch","Create_Batch_Feature"]}],"uid":"c13285ab85b8fcde6241c4d34b6035d5"}],"uid":"8fb3a91ba5aaf9de24cc8a92edc82b5d"}],"name":"categories"}