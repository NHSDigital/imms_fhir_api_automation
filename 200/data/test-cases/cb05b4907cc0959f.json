{"uid":"cb05b4907cc0959f","name":"Verify that VACCINATION PROCEDURE TERM, VACCINE PRODUCT TERM, SITE OF VACCINATION TERM, ROUTE OF VACCINATION TERM fields are mapped to correct instance of coding.display fields in imms delta table","fullName":"features.APITests.steps.test_create_steps#test_verify_that_vaccination_procedure_term_vaccine_product_term_site_of_vaccination_term_route_of_vaccination_term_fields_are_mapped_to_correct_instance_of_codingdisplay_fields_in_imms_delta_table","historyId":"687a6d2836753ccb9870eb8f9adc4f09","time":{"start":1766412957656,"stop":1766412958043,"duration":387},"description":"/home/runner/work/imms_fhir_api_automation/imms_fhir_api_automation/features/APITests/create.feature: Verify that VACCINATION_PROCEDURE_TERM, VACCINE_PRODUCT_TERM, SITE_OF_VACCINATION_TERM, ROUTE_OF_VACCINATION_TERM fields are mapped to correct instance of coding.display fields in imms delta table","descriptionHtml":"<p>/home/runner/work/imms_fhir_api_automation/imms_fhir_api_automation/features/APITests/create.feature: Verify that VACCINATION_PROCEDURE_TERM, VACCINE_PRODUCT_TERM, SITE_OF_VACCINATION_TERM, ROUTE_OF_VACCINATION_TERM fields are mapped to correct instance of coding.display fields in imms delta table</p>\n","status":"failed","statusMessage":"AssertionError: \n          {\n            \"error\": \"invalid_request\",\n            \"error_description\": \"client_id is missing\",\n            \"message_id\": \"rrt-3752134920934777204-a-geu2-677194-96443526-1\"\n          }","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the POST Create API for different vaccine types', ScenarioTem... description='', tags={'supplier_name_MEDIUS', 'patient_id_Random', 'Delete_cleanUp', 'vaccine_type_HEPB'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:80: in pytest_bdd_after_scenario\n    context = request.getfixturevalue('context')\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:898: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\nfeatures/conftest.py:72: in context\n    get_tokens(ctx, ctx.supplier_name)\nutilities/api_gen_token.py:89: in get_tokens\n    context.token = get_access_token(context)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncontext = <utilities.context.ScenarioContext object at 0x7f0c36a60650>\n\n    def get_access_token(context):\n        login_session = requests.session()\n        client_id = context.auth_client_Id\n        client_secret = context.auth_client_Secret\n        callback_url = context.callback_url\n        username = context.username\n        auth_url = context.auth_url\n        token_url = context.token_url\n        scope = context.scope\n    \n        #Login Page\n        authorize_resp = login_session.get(\n            auth_url,\n            params={\n                \"client_id\": client_id,\n                \"redirect_uri\": callback_url,\n                \"response_type\": \"code\",\n                \"scope\": scope,\n                \"state\": str(uuid.uuid4()),\n            },\n        )\n>       assert authorize_resp.status_code == 200, authorize_resp.text\nE       AssertionError: \nE                 {\nE                   \"error\": \"invalid_request\",\nE                   \"error_description\": \"client_id is missing\",\nE                   \"message_id\": \"rrt-3752134920934777204-a-geu2-677194-96443526-1\"\nE                 }\n\nutilities/api_gen_token.py:38: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_pytest_bdd_example","time":{"start":1766412957656,"stop":1766412957656,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"/home/runner/work/imms_fhir_api_automation/imms_fhir_api_automation/features/APITests/create.feature: Verify that VACCINATION_PROCEDURE_TERM, VACCINE_PRODUCT_TERM, SITE_OF_VACCINATION_TERM, ROUTE_OF_VACCINATION_TERM fields are mapped to correct instance of coding.display fields in imms delta table","status":"failed","statusMessage":"AssertionError: \n          {\n            \"error\": \"invalid_request\",\n            \"error_description\": \"client_id is missing\",\n            \"message_id\": \"rrt-3752134920934777204-a-geu2-677194-96443526-1\"\n          }","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the POST Create API for different vaccine types', ScenarioTem... description='', tags={'supplier_name_MEDIUS', 'patient_id_Random', 'Delete_cleanUp', 'vaccine_type_HEPB'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:80: in pytest_bdd_after_scenario\n    context = request.getfixturevalue('context')\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:898: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\nfeatures/conftest.py:72: in context\n    get_tokens(ctx, ctx.supplier_name)\nutilities/api_gen_token.py:89: in get_tokens\n    context.token = get_access_token(context)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncontext = <utilities.context.ScenarioContext object at 0x7f0c36a60650>\n\n    def get_access_token(context):\n        login_session = requests.session()\n        client_id = context.auth_client_Id\n        client_secret = context.auth_client_Secret\n        callback_url = context.callback_url\n        username = context.username\n        auth_url = context.auth_url\n        token_url = context.token_url\n        scope = context.scope\n    \n        #Login Page\n        authorize_resp = login_session.get(\n            auth_url,\n            params={\n                \"client_id\": client_id,\n                \"redirect_uri\": callback_url,\n                \"response_type\": \"code\",\n                \"scope\": scope,\n                \"state\": str(uuid.uuid4()),\n            },\n        )\n>       assert authorize_resp.status_code == 200, authorize_resp.text\nE       AssertionError: \nE                 {\nE                   \"error\": \"invalid_request\",\nE                   \"error_description\": \"client_id is missing\",\nE                   \"message_id\": \"rrt-3752134920934777204-a-geu2-677194-96443526-1\"\nE                 }\n\nutilities/api_gen_token.py:38: AssertionError","steps":[],"attachments":[{"uid":"783f64cf08d0773f","name":"Step Failed: Valid json payload is created where vaccination terms has multiple instance of coding with different coding system","source":"783f64cf08d0773f.txt","type":"text/plain","size":352}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"epic","value":"Immunization Service"},{"name":"suite","value":"Create the immunization event for a patient"},{"name":"feature","value":"Create the immunization event for a patient"},{"name":"tag","value":"Delete_cleanUp"},{"name":"tag","value":"functional"},{"name":"tag","value":"supplier_name_MEDIUS"},{"name":"tag","value":"patient_id_Random"},{"name":"tag","value":"Create_Feature"},{"name":"tag","value":"vaccine_type_HEPB"},{"name":"parentSuite","value":"features.APITests.steps"},{"name":"host","value":"runnervmh13bl"},{"name":"thread","value":"2535-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"features.APITests.steps.test_create_steps"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":1,"broken":0,"skipped":0,"passed":4,"unknown":0,"total":5},"items":[{"uid":"28c0ec2d0ddf228c","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/199/#testresult/28c0ec2d0ddf228c","status":"passed","time":{"start":1766268961193,"stop":1766268965282,"duration":4089}},{"uid":"15791c293bf0b69a","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/197/#testresult/15791c293bf0b69a","status":"passed","time":{"start":1766170560367,"stop":1766170569361,"duration":8994}},{"uid":"ee9672d679ce25d1","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/196/#testresult/ee9672d679ce25d1","status":"passed","time":{"start":1765967330160,"stop":1765967334264,"duration":4104}},{"uid":"bf719d795af2eeaa","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/194/#testresult/bf719d795af2eeaa","status":"passed","time":{"start":1765899269717,"stop":1765899276880,"duration":7163}}]},"tags":["functional","supplier_name_MEDIUS","vaccine_type_HEPB","Create_Feature","patient_id_Random","Delete_cleanUp"]},"source":"cb05b4907cc0959f.json","parameterValues":[]}