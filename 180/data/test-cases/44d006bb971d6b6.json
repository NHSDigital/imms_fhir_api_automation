{"uid":"44d006bb971d6b6","name":"Verify that VACCINATION PROCEDURE TERM, VACCINE PRODUCT TERM, SITE OF VACCINATION TERM, ROUTE OF VACCINATION TERM fields are blank in imms delta table if no text or value string or display field is present","fullName":"features.APITests.steps.test_create_steps#test_verify_that_vaccination_procedure_term_vaccine_product_term_site_of_vaccination_term_route_of_vaccination_term_fields_are_blank_in_imms_delta_table_if_no_text_or_value_string_or_display_field_is_present","historyId":"289e074ac9775921d811d7083129dd68","time":{"start":1765545408466,"stop":1765545408468,"duration":2},"description":"/home/runner/work/imms_fhir_api_automation/imms_fhir_api_automation/features/APITests/create.feature: Verify that VACCINATION_PROCEDURE_TERM, VACCINE_PRODUCT_TERM, SITE_OF_VACCINATION_TERM, ROUTE_OF_VACCINATION_TERM fields are blank in imms delta table if no text or value string or display field is present","descriptionHtml":"<p>/home/runner/work/imms_fhir_api_automation/imms_fhir_api_automation/features/APITests/create.feature: Verify that VACCINATION_PROCEDURE_TERM, VACCINE_PRODUCT_TERM, SITE_OF_VACCINATION_TERM, ROUTE_OF_VACCINATION_TERM fields are blank in imms delta table if no text or value string or display field is present</p>\n","status":"broken","statusMessage":"requests.exceptions.InvalidURL: URL has an invalid label.","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the POST Create API for different vaccine types', ScenarioTem...)], description='', tags={'Delete_cleanUp', 'patient_id_Random', 'vaccine_type_RSV', 'supplier_name_RAVS'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:80: in pytest_bdd_after_scenario\n    context = request.getfixturevalue('context')\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:898: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\nfeatures/conftest.py:72: in context\n    get_tokens(ctx, ctx.supplier_name)\nutilities/api_gen_token.py:89: in get_tokens\n    context.token = get_access_token(context)\nutilities/api_gen_token.py:28: in get_access_token\n    authorize_resp = login_session.get(\nvenv/lib/python3.11/site-packages/requests/sessions.py:602: in get\n    return self.request(\"GET\", url, **kwargs)\nvenv/lib/python3.11/site-packages/requests/sessions.py:575: in request\n    prep = self.prepare_request(req)\nvenv/lib/python3.11/site-packages/requests/sessions.py:484: in prepare_request\n    p.prepare(\nvenv/lib/python3.11/site-packages/requests/models.py:367: in prepare\n    self.prepare_url(url, params)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <PreparedRequest [GET]>\nurl = 'https://.api.service.nhs.uk/oauth2-mock/authorize'\nparams = OrderedDict([('client_id', 'oa8lpBVlD25Nmy50zoIDc4qTiA9b8qrV'), ('redirect_uri', 'https://oauth.pstmn.io/v1/callback'), ('response_type', 'code'), ('scope', 'nhs-cis2'), ('state', '21c908f6-10f0-4cc5-94a9-e14cd89a1d4f')])\n\n    def prepare_url(self, url, params):\n        \"\"\"Prepares the given HTTP URL.\"\"\"\n        #: Accept objects that have string representations.\n        #: We're unable to blindly call unicode/str functions\n        #: as this will include the bytestring indicator (b'')\n        #: on python 3.x.\n        #: https://github.com/psf/requests/pull/2238\n        if isinstance(url, bytes):\n            url = url.decode(\"utf8\")\n        else:\n            url = str(url)\n    \n        # Remove leading whitespaces from url\n        url = url.lstrip()\n    \n        # Don't do any URL preparation for non-HTTP schemes like `mailto`,\n        # `data` etc to work around exceptions from `url_parse`, which\n        # handles RFC 3986 only.\n        if \":\" in url and not url.lower().startswith(\"http\"):\n            self.url = url\n            return\n    \n        # Support for unicode domain names and paths.\n        try:\n            scheme, auth, host, port, path, query, fragment = parse_url(url)\n        except LocationParseError as e:\n            raise InvalidURL(*e.args)\n    \n        if not scheme:\n            raise MissingSchema(\n                f\"Invalid URL {url!r}: No scheme supplied. \"\n                f\"Perhaps you meant https://{url}?\"\n            )\n    \n        if not host:\n            raise InvalidURL(f\"Invalid URL {url!r}: No host supplied\")\n    \n        # In general, we want to try IDNA encoding the hostname if the string contains\n        # non-ASCII characters. This allows users to automatically get the correct IDNA\n        # behaviour. For strings containing only ASCII characters, we need to also verify\n        # it doesn't start with a wildcard (*), before allowing the unencoded hostname.\n        if not unicode_is_ascii(host):\n            try:\n                host = self._get_idna_encoded_host(host)\n            except UnicodeError:\n                raise InvalidURL(\"URL has an invalid label.\")\n        elif host.startswith((\"*\", \".\")):\n>           raise InvalidURL(\"URL has an invalid label.\")\nE           requests.exceptions.InvalidURL: URL has an invalid label.\n\nvenv/lib/python3.11/site-packages/requests/models.py:456: InvalidURL","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"setup_environment","time":{"start":1765545405482,"stop":1765545405483,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_context","time":{"start":1765545405486,"stop":1765545407184,"duration":1698},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pytest_bdd_example","time":{"start":1765545408466,"stop":1765545408466,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"/home/runner/work/imms_fhir_api_automation/imms_fhir_api_automation/features/APITests/create.feature: Verify that VACCINATION_PROCEDURE_TERM, VACCINE_PRODUCT_TERM, SITE_OF_VACCINATION_TERM, ROUTE_OF_VACCINATION_TERM fields are blank in imms delta table if no text or value string or display field is present","status":"broken","statusMessage":"requests.exceptions.InvalidURL: URL has an invalid label.","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the POST Create API for different vaccine types', ScenarioTem...)], description='', tags={'Delete_cleanUp', 'patient_id_Random', 'vaccine_type_RSV', 'supplier_name_RAVS'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert (\n            not self.is_historic()\n        ), \"Cannot directly call a historic hook - use call_historic instead.\"\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\nvenv/lib/python3.11/site-packages/pluggy/_hooks.py:513: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nvenv/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:80: in pytest_bdd_after_scenario\n    context = request.getfixturevalue('context')\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\nvenv/lib/python3.11/site-packages/_pytest/fixtures.py:898: in call_fixture_func\n    fixture_result = fixturefunc(**kwargs)\nfeatures/conftest.py:72: in context\n    get_tokens(ctx, ctx.supplier_name)\nutilities/api_gen_token.py:89: in get_tokens\n    context.token = get_access_token(context)\nutilities/api_gen_token.py:28: in get_access_token\n    authorize_resp = login_session.get(\nvenv/lib/python3.11/site-packages/requests/sessions.py:602: in get\n    return self.request(\"GET\", url, **kwargs)\nvenv/lib/python3.11/site-packages/requests/sessions.py:575: in request\n    prep = self.prepare_request(req)\nvenv/lib/python3.11/site-packages/requests/sessions.py:484: in prepare_request\n    p.prepare(\nvenv/lib/python3.11/site-packages/requests/models.py:367: in prepare\n    self.prepare_url(url, params)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <PreparedRequest [GET]>\nurl = 'https://.api.service.nhs.uk/oauth2-mock/authorize'\nparams = OrderedDict([('client_id', 'oa8lpBVlD25Nmy50zoIDc4qTiA9b8qrV'), ('redirect_uri', 'https://oauth.pstmn.io/v1/callback'), ('response_type', 'code'), ('scope', 'nhs-cis2'), ('state', '21c908f6-10f0-4cc5-94a9-e14cd89a1d4f')])\n\n    def prepare_url(self, url, params):\n        \"\"\"Prepares the given HTTP URL.\"\"\"\n        #: Accept objects that have string representations.\n        #: We're unable to blindly call unicode/str functions\n        #: as this will include the bytestring indicator (b'')\n        #: on python 3.x.\n        #: https://github.com/psf/requests/pull/2238\n        if isinstance(url, bytes):\n            url = url.decode(\"utf8\")\n        else:\n            url = str(url)\n    \n        # Remove leading whitespaces from url\n        url = url.lstrip()\n    \n        # Don't do any URL preparation for non-HTTP schemes like `mailto`,\n        # `data` etc to work around exceptions from `url_parse`, which\n        # handles RFC 3986 only.\n        if \":\" in url and not url.lower().startswith(\"http\"):\n            self.url = url\n            return\n    \n        # Support for unicode domain names and paths.\n        try:\n            scheme, auth, host, port, path, query, fragment = parse_url(url)\n        except LocationParseError as e:\n            raise InvalidURL(*e.args)\n    \n        if not scheme:\n            raise MissingSchema(\n                f\"Invalid URL {url!r}: No scheme supplied. \"\n                f\"Perhaps you meant https://{url}?\"\n            )\n    \n        if not host:\n            raise InvalidURL(f\"Invalid URL {url!r}: No host supplied\")\n    \n        # In general, we want to try IDNA encoding the hostname if the string contains\n        # non-ASCII characters. This allows users to automatically get the correct IDNA\n        # behaviour. For strings containing only ASCII characters, we need to also verify\n        # it doesn't start with a wildcard (*), before allowing the unencoded hostname.\n        if not unicode_is_ascii(host):\n            try:\n                host = self._get_idna_encoded_host(host)\n            except UnicodeError:\n                raise InvalidURL(\"URL has an invalid label.\")\n        elif host.startswith((\"*\", \".\")):\n>           raise InvalidURL(\"URL has an invalid label.\")\nE           requests.exceptions.InvalidURL: URL has an invalid label.\n\nvenv/lib/python3.11/site-packages/requests/models.py:456: InvalidURL","steps":[],"attachments":[{"uid":"bd323567fa1b2559","name":"Step Failed: Valid json payload is created where vaccination terms has no text or value string or display field","source":"bd323567fa1b2559.txt","type":"text/plain","size":154}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"epic","value":"Immunization Service"},{"name":"suite","value":"Create the immunization event for a patient"},{"name":"feature","value":"Create the immunization event for a patient"},{"name":"tag","value":"vaccine_type_RSV"},{"name":"tag","value":"Create_Feature"},{"name":"tag","value":"functional"},{"name":"tag","value":"Delete_cleanUp"},{"name":"tag","value":"patient_id_Random"},{"name":"tag","value":"supplier_name_RAVS"},{"name":"parentSuite","value":"features.APITests.steps"},{"name":"host","value":"runnervm6qbrg"},{"name":"thread","value":"2534-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"features.APITests.steps.test_create_steps"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":23,"unknown":0,"total":24},"items":[{"uid":"67aac93ce63ee88a","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/179/#testresult/67aac93ce63ee88a","status":"passed","time":{"start":1765465712538,"stop":1765465716708,"duration":4170}},{"uid":"5ce147656602e947","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/177/#testresult/5ce147656602e947","status":"passed","time":{"start":1765398446609,"stop":1765398450096,"duration":3487}},{"uid":"2138f4fbb7e917cc","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/176/#testresult/2138f4fbb7e917cc","status":"passed","time":{"start":1765384978489,"stop":1765384981578,"duration":3089}},{"uid":"1cc6851f8d57a63","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/175/#testresult/1cc6851f8d57a63","status":"passed","time":{"start":1765000607983,"stop":1765000612207,"duration":4224}},{"uid":"93c316500e60e6af","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/173/#testresult/93c316500e60e6af","status":"passed","time":{"start":1764972384042,"stop":1764972390300,"duration":6258}},{"uid":"97fda187cd56493d","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/171/#testresult/97fda187cd56493d","status":"passed","time":{"start":1764332987716,"stop":1764332996925,"duration":9209}},{"uid":"5fe7c8b5c146c8f4","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/170/#testresult/5fe7c8b5c146c8f4","status":"passed","time":{"start":1764256554929,"stop":1764256569487,"duration":14558}},{"uid":"7e0ad97094d74c97","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/169/#testresult/7e0ad97094d74c97","status":"passed","time":{"start":1764235990640,"stop":1764235995108,"duration":4468}},{"uid":"85a3891892670c3b","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/168/#testresult/85a3891892670c3b","status":"passed","time":{"start":1764230951898,"stop":1764230956079,"duration":4181}},{"uid":"44ada823adca7fdc","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/167/#testresult/44ada823adca7fdc","status":"passed","time":{"start":1764183928339,"stop":1764183932098,"duration":3759}},{"uid":"8e570411430513dc","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/166/#testresult/8e570411430513dc","status":"passed","time":{"start":1764182770328,"stop":1764182773838,"duration":3510}},{"uid":"6a5c6c7f9589ccf6","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/165/#testresult/6a5c6c7f9589ccf6","status":"passed","time":{"start":1764181906230,"stop":1764181909840,"duration":3610}},{"uid":"ad41f210d66ffb80","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/164/#testresult/ad41f210d66ffb80","status":"passed","time":{"start":1764147800946,"stop":1764147803620,"duration":2674}},{"uid":"ba8d54b005c2f30a","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/162/#testresult/ba8d54b005c2f30a","status":"passed","time":{"start":1764003030297,"stop":1764003034562,"duration":4265}},{"uid":"d87ef13d8e27b371","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/161/#testresult/d87ef13d8e27b371","status":"passed","time":{"start":1764002585782,"stop":1764002589046,"duration":3264}},{"uid":"d4e5bfbd2cccfb65","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/159/#testresult/d4e5bfbd2cccfb65","status":"passed","time":{"start":1763998173061,"stop":1763998177878,"duration":4817}},{"uid":"9c9f1a0013fa0ebe","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/158/#testresult/9c9f1a0013fa0ebe","status":"passed","time":{"start":1763996711379,"stop":1763996715452,"duration":4073}},{"uid":"2091a365c039f3f2","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/157/#testresult/2091a365c039f3f2","status":"passed","time":{"start":1763992846739,"stop":1763992850267,"duration":3528}},{"uid":"de46039f8d995da7","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/156/#testresult/de46039f8d995da7","status":"passed","time":{"start":1763555507912,"stop":1763555511618,"duration":3706}},{"uid":"93b903ffc3e4e6e3","reportUrl":"https://NHSDigital.github.io/imms_fhir_api_automation/155/#testresult/93b903ffc3e4e6e3","status":"passed","time":{"start":1763366509667,"stop":1763366514569,"duration":4902}}]},"tags":["functional","Create_Feature","patient_id_Random","supplier_name_RAVS","vaccine_type_RSV","Delete_cleanUp"]},"source":"44d006bb971d6b6.json","parameterValues":[]}